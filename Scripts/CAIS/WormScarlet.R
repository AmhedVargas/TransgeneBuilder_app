##WormScarlet
A="ATGCCCAAAAAGAAACGAAAGGTCGTTTCTAAGGGCGAAGCCGTCATCAAGGAGTTTATGCGTTTCAAAGTTCACATGGAGGGTTCGATGAACGGACATGAATTCGAGATCGAGGGAGAGGGAGAGGGACGTCCGTACGAAGGTACACAAACGGCCAAGCTCAAAGTAACAAAAGGAGGACCATTACCATTCTCGTGGGATATTCTCAGCCCACAGTTTATGTATGGTTCCCGTGCTTTCACTAAGCATCCAGCAGATATCCCAGATTATTATAAACAATCTTTCCCAGAGGGATTTAAGTGGGAACGTGTTATGAATTTCGAGGACGGAGGAGCCGTTACCGTTACCCAAGATACTTCCCTTGAGGATGGAACTCTTATCTATAAGGTTAAGCTTAGAGGGACAAATTTCCCGCCAGATGGACCAGTCATGCAAAAAAAGACTATGGGATGGGAAGCTTCGACAGAAAGACTTTACCCAGAGGATGGTGTTCTTAAAGGGGATATTAAAATGGCTCTTAGACTTAAGGACGGCGGACGTTATCTTGCTGATTTCAAGACCACATACAAGGCTAAGAAGCCTGTCCAAATGCCAGGAGCCTACAATGTGGATCGGAAGCTCGATATTACCTCACACAACGAAGACTATACTGTAGTCGAACAATATGAACGTTCGGAGGGACGTCATTCGACCGGCGGTATGGACGAGCTGTACAAGTCTAGACGCCGTAAGGCCAACCCAACAAAGTTGTCTGAGAACGCCAAGAAATTGGCTAAGGAGGTCGAAAATTAA"
B="ATGCCCAAGAAGAAGCGAAAGGTCGTTTCTAAGGGCGAGGCAGTTATCAAAGAGTTCATGAGATTCAAAGTTCACATGGAGGGAAGTATGAATGGACACGAGTTTGAGATTGAAGGAGAAGGAGAAGGACGTCCATACGAAGGAACACAAACCGCAAAGCTTAAAGTCACGAAGGGAGGACCACTCCCATTCTCGTGGGACATTCTTTCCCCACAATTCATGTACGGGTCACGTGCTTTCACTAAACATCCGGCCGATATCCCGGACTATTATAAACAGTCTTTCCCAGAAGGTTTCAAGTGGGAGAGAGTTATGAACTTCGAAGATGGTGGAGCAGTGACCGTTACCCAAGATACAAGCCTGGAAGATGGAACACTCATCTACAAGGTTAAGCTGCGTGGCACTAATTTTCCTCCGGATGGTCCCGTCATGCAGAAAAAGACGATGGGTTGGGAAGCCTCTACGGAGCGTTTGTATCCTGAGGATGGAGTCCTGAAAGGTGATATCAAGATGGCCCTTCGTCTGAAAGATGGAGGACGTTATCTCGCTGATTTTAAAACCACTTATAAAGCAAAGAAGCCGGTGCAAATGCCAGGAGCCTATAATGTTGACAGAAAGTTGGATATCACGTCGCACAATGAGGATTACACAGTTGTGGAACAGTACGAAAGATCAGAAGGCCGCCATTCCACTGGAGGAATGGACGAGCTTTATAAGTCACGCAGACGTAAAGCAAATCCGACCAAGCTATCGGAGAATGCTAAAAAGCTTGCTAAAGAGGTAGAGAATTAG"
C="ATGCCCAAAAAGAAACGAAAGGTCGTTTCTAAGGGCGAAGCCGTAATTAAGGAGTTTATGCGTTTCAAGGTCCACATGGAAGGATCTATGAATGGACACGAGTTCGAGATTGAAGGAGAAGGTGAAGGTCGACCATACGAAGGTACCCAAACAGCTAAGCTCAAGGTCACTAAAGGAGGACCACTTCCATTCTCTTGGGATATCCTTTCGCCACAATTTATGTACGGATCCCGTGCCTTCACCAAACACCCAGCCGACATACCTGACTACTACAAGCAAAGCTTCCCCGAGGGCTTCAAATGGGAGCGAGTTATGAATTTCGAAGATGGAGGAGCGGTTACGGTTACACAAGACACATCCTTGGAGGATGGTACCCTTATCTATAAAGTCAAGTTACGTGGAACTAACTTCCCACCAGACGGACCAGTGATGCAGAAGAAGACTATGGGATGGGAAGCTTCGACTGAGCGTTTGTACCCAGAAGATGGAGTTTTGAAGGGAGACATCAAGATGGCTCTCCGTCTTAAGGATGGAGGACGTTACCTCGCTGATTTTAAAACTACCTATAAGGCTAAGAAACCAGTGCAAATGCCAGGAGCTTACAACGTTGATCGAAAGTTAGACATAACAAGTCACAACGAAGACTACACTGTGGTTGAACAGTACGAGAGATCTGAAGGACGTCACTCTACCGGAGGAATGGATGAATTGTACAAGTCTCGCCGACGAAAGGCAAACCCTACCAAGCTCTCGGAGAATGCAAAAAAGCTTGCCAAGGAAGTTGAAAATTAA"

CAp9 = "ATGCCCAAAAAGAAACGAAAGGTCGTTTCTAAGGGCGAAGCCGTCATCAAGGAGTTCATGCGTTTCAAGGTCCACATGGAGGGATCCATGAACGGACACGAGTTCGAGATCGAGGGAGAGGGAGAGGGACGTCCATACGAGGGAACCCAAACCGCCAAGCTCAAGGTCACCAAGGGAGGACCACTCCCATTCTCCTGGGACATCCTCTCCCCACAGTTCATGTACGGATCCCGTGCCTTCACCAAGCACCCAGCCGACATCCCAGATTACTACAAGCAATCCTTCCCAGAGGGATTCAAGTGGGAGCGTGTCATGAACTTCGAGGACGGAGGAGCCGTCACCGTCACCCAAGACACCTCCCTCGAGGACGGAACCCTCATCTACAAGGTCAAGCTCCGTGGAACCAACTTCCCACCAGATGGACCAGTCATGCAAAAGAAGACTATGGGATGGGAGGCCTCCACCGAGCGTCTCTACCCAGAGGACGGAGTCCTCAAGGGAGACATCAAGATGGCCCTCAGACTCAAGGACGGAGGACGTTACCTTGCCGACTTCAAGACCACCTACAAGGCCAAGAAGCCAGTCCAAATGCCAGGAGCCTACAACGTCGACCGTAAGCTCGACATCACCTCCCACAACGAGGACTACACCGTCGTCGAGCAATACGAGCGTTCCGAGGGACGTCACTCCACCGGAGGAATGGACGAGCTCTACAAGTCCCGTCGTCGTAAGGCCAACCCAACCAAGCTCTCCGAGAACGCCAAGAAGCTCGCCAAGGAGGTCGAGAATTAA"

CAp7 = "ATGCCCAAAAAGAAACGAAAGGTCGTTTCTAAGGGCGAAGCCGTCATCAAGGAGTTCATGCGTTTCAAGGTCCACATGGAGGGTAGTATGAACGGACACGAGTTCGAGATCGAGGGAGAGGGAGAGGGACGGCCATACGAGGGAACCCAAACCGCCAAGCTCAAGGTCACCAAAGGGGGACCACTCCCATTCTCCTGGGACATCCTCTCCCCACAGTTCATGTACGGAAGTCGTGCCTTCACCAAGCACCCAGCCGACATCCCAGATTACTATAAGCAGTCCTTCCCAGAGGGATTCAAGTGGGAGCGTGTCATGAACTTCGAGGATGGAGGAGCCGTCACCGTCACCCAAGACACTTCCCTCGAGGATGGAACCCTCATCTACAAGGTCAAGCTTCGTGGAACCAACTTCCCCCCAGATGGACCAGTCATGCAAAAGAAGACTATGGGATGGGAGGCCTCGACCGAACGTCTCTACCCAGAGGACGGAGTCCTCAAAGGAGATATCAAGATGGCCCTAAGACTCAAGGACGGAGGACGTTACCTTGCCGATTTCAAGACCACGTACAAGGCTAAGAAGCCAGTCCAAATGCCAGGAGCCTACAACGTAGACCGTAAGCTCGACATCACCTCCCACAACGAGGACTACACGGTCGTCGAACAATACGAACGTTCCGAGGGACGTCACTCCACCGGAGGGATGGACGAGCTCTACAAGTCCCGTCGTCGTAAGGCCAACCCAACGAAGCTCTCCGAGAACGCCAAGAAGCTCGCCAAGGAGGTCGAGAATTAA"

CAp5 = "ATGCCCAAAAAGAAACGAAAGGTCGTTTCTAAGGGCGAAGCCGTCATCAAGGAGTTCATGCGGTTCAAGGTCCACATGGAGGGTAGTATGAACGGACACGAGTTCGAGATAGAGGGAGAGGGAGAGGGACGGCCATACGAGGGAACCCAAACGGCCAAGCTCAAGGTCACCAAAGGGGGACCACTCCCATTCTCCTGGGATATCCTCTCCCCACAGTTCATGTACGGAAGTCGTGCCTTCACCAAGCACCCCGCCGACATACCAGATTACTATAAGCAGTCCTTCCCAGAGGGATTCAAATGGGAGCGTGTCATGAACTTCGAGGATGGAGGAGCCGTCACCGTCACGCAAGACACGTCCCTCGAGGATGGAACCCTAATCTACAAGGTAAAGCTTCGTGGAACCAACTTCCCCCCAGATGGACCAGTCATGCAAAAGAAAACTATGGGATGGGAAGCCTCGACCGAACGTCTCTACCCAGAGGACGGGGTCCTCAAAGGAGATATCAAGATGGCCCTAAGACTCAAGGACGGAGGACGGTACCTTGCCGATTTCAAGACCACGTACAAGGCTAAGAAGCCAGTACAAATGCCAGGGGCCTACAACGTAGACCGTAAACTCGACATCACGTCCCACAACGAGGACTACACGGTCGTCGAACAATACGAACGTTCCGAAGGACGTCACTCCACCGGAGGGATGGACGAGCTCTACAAGTCCCGGCGTCGTAAGGCCAACCCAACGAAGCTCTCCGAGAACGCCAAAAAGCTCGCCAAAGAGGTCGAGAATTAA"

CAp3 = "ATGCCCAAAAAGAAACGAAAGGTCGTTTCTAAGGGCGAAGCGGTCATAAAGGAGTTCATGCGGTTCAAGGTACACATGGAGGGTAGTATGAACGGACATGAGTTCGAGATAGAGGGAGAAGGAGAGGGACGGCCATACGAAGGAACCCAAACGGCCAAGCTAAAGGTAACCAAAGGGGGGCCACTACCATTCTCCTGGGATATCCTCTCCCCCCAGTTCATGTACGGAAGTCGTGCCTTTACCAAGCACCCCGCCGACATACCAGATTACTATAAGCAGTCCTTCCCCGAGGGATTCAAATGGGAACGTGTAATGAACTTCGAGGATGGAGGAGCGGTCACCGTCACGCAAGACACGTCCCTCGAGGATGGAACCCTAATCTATAAGGTAAAGCTACGTGGGACCAACTTCCCCCCAGATGGACCCGTCATGCAAAAGAAAACTATGGGATGGGAAGCCTCGACCGAACGTCTCTATCCAGAGGACGGGGTCCTCAAAGGGGATATCAAAATGGCCCTAAGACTCAAAGACGGGGGACGGTACCTTGCGGATTTCAAAACCACGTACAAGGCGAAGAAGCCAGTACAAATGCCAGGGGCCTATAACGTAGACCGTAAACTCGACATCACGTCCCACAATGAGGACTACACGGTAGTCGAACAGTACGAACGGTCCGAAGGACGTCATTCCACCGGAGGGATGGATGAGCTATACAAATCCCGGCGTCGTAAAGCCAACCCAACGAAGCTCAGTGAGAACGCCAAAAAGCTCGCCAAAGAGGTAGAGAATTAA"

CAp1 = "ATGCCCAAAAAGAAACGAAAGGTCGTTTCTAAGGGCGAAGCGGTAATAAAGGAATTTATGCGGTTTAAGGTACACATGGAAGGTAGTATGAATGGGCATGAGTTTGAAATAGAAGGGGAAGGAGAAGGGCGGCCCTATGAAGGGACGCAAACGGCGAAGCTAAAAGTAACCAAAGGGGGGCCACTACCATTTTCCTGGGATATCCTAAGTCCCCAGTTTATGTATGGGAGTCGGGCGTTTACCAAACACCCCGCGGACATACCCGATTATTATAAGCAGAGTTTCCCCGAAGGGTTCAAATGGGAACGGGTAATGAATTTTGAGGATGGGGGAGCGGTAACGGTAACGCAGGACACGTCCCTAGAGGATGGGACCCTAATCTATAAAGTAAAACTACGGGGGACCAATTTTCCCCCCGATGGACCCGTCATGCAGAAAAAAACGATGGGATGGGAAGCCAGTACCGAACGGCTATATCCAGAAGATGGGGTACTAAAAGGGGATATCAAAATGGCCCTACGGCTCAAAGATGGGGGGCGGTATCTAGCGGATTTCAAAACCACGTATAAAGCGAAAAAACCAGTACAGATGCCAGGGGCCTATAACGTAGATCGGAAACTAGATATCACGAGTCATAATGAAGATTACACGGTAGTCGAACAGTACGAACGGAGTGAAGGGCGGCATTCCACGGGAGGGATGGATGAACTATATAAATCCCGGCGGCGTAAAGCGAATCCCACGAAACTCAGTGAGAATGCCAAAAAACTAGCGAAAGAGGTAGAGAATTAA"


nseqs=c(A, B, C, CAp9, CAp7, CAp5, CAp3, CAp1)

intloc=c(51,256,418)


###Copy codons from:
Secu="ATGCCCAAAAAGAAACGAAAGGTCGTTTCTAAGGGCGAAGCCGTCATCAAGGAGTTTATGCGTTTCAAAGTTCACATGGAGGGTTCGATGAACGGACATGAATTCGAGATCGAGGGAGAGGGAGAGGGACGTCCGTACGAAGGTACACAAACGGCCAAGCTCAAAGTAACAAAAGGAGGACCATTACCATTCTCGTGGGATATTCTCAGCCCACAGTTTATGTATGGTTCCCGTGCTTTCACTAAGCATCCAGCAGATATCCCAGATTATTATAAACAATCTTTCCCAGAGGGATTTAAGTGGGAACGTGTTATGAATTTCGAGGACGGAGGAGCCGTTACCGTTACCCAAGATACTTCCCTTGAGGATGGAACTCTTATCTATAAGGTTAAGCTTAGAGGGACAAATTTCCCGCCAGATGGACCAGTCATGCAAAAAAAGACTATGGGATGGGAAGCTTCGACAGAAAGACTTTACCCAGAGGATGGTGTTCTTAAAGGGGATATTAAAATGGCTCTTAGACTTAAGGACGGCGGACGTTATCTTGCTGATTTCAAGACCACATACAAGGCTAAGAAGCCTGTCCAAATGCCAGGAGCCTACAATGTGGATCGGAAGCTCGATATTACCTCACACAACGAAGACTATACTGTAGTCGAACAATATGAACGTTCGGAGGGACGTCATTCGACCGGCGGTATGGACGAGCTGTACAAGTCTAGACGCCGTAAGGCCAACCCAACAAAGTTGTCTGAGAACGCCAAGAAATTGGCTAAGGAGGTCGAAAATTAA"

# +- 1aa closest to reading frame

stt=(intloc-(intloc %% 3)) - 2
edd=(intloc-(intloc %% 3)) + 3
bps=c()
for(i in 1:length(stt)){bps=append(bps,c(stt[i]:edd[i]))}


Secu=unlist(strsplit(Secu,""))

nSeqs=c()
for(seq in nseqs){
  seq=unlist(strsplit(seq,""))
  seq[bps]=Secu[bps]
  nSeqs=append(nSeqs,paste(seq,collapse="",sep=""))
}

##Redo tables
caiss <- data.frame(ca1 = rep(NA,length(nSeqs)),ca2 = rep(NA,length(nSeqs)),ca3 = rep(NA,length(nSeqs)),ca4 = rep(NA,length(nSeqs)),ca5 = rep(NA,length(nSeqs)))

for(i in 1:length(nSeqs)){
  caiss[i,]=c(CalculateCAI(nSeqs[i],CAIS,1,AAtoCodF),CalculateCAI(nSeqs[i],CAIS,2,AAtoCodF),CalculateCAI(nSeqs[i],CAIS,3,AAtoCodF),CalculateCAI(nSeqs[i],CAIS,4,AAtoCodF),CalculateCAI(nSeqs[i],CAIS,5,AAtoCodF)) 
}


nbpi <- data.frame(pi3 = rep(NA,length(nSeqs)),pi4 = rep(NA,length(nSeqs)),pi5 = rep(NA,length(nSeqs)))

for(i in 1:length(nSeqs)){
  nbpi[i,]=c(length(unique(Strfindpies(nSeqs[i],Pies,3))), length(unique(Strfindpies(nSeqs[i],Pies,4))), length(unique(Strfindpies(nSeqs[i],Pies,5)))) 
}



data=cbind(caiss,nbpi)


writeLines(nSeqs,"WormS_CAI.fasta")










write.table(data, "ValuesW_CAI.tsv",sep="\t", row.names=F, col.names=F)

### Read new values
SGFPs = read.table("WormS_CAI.tsv", sep="\t", header=F,stringsAsFactors=F)

colnames(SGFPs) =c("Sequence","GLO_Score","GLO_LowestScore","GLO_LowestWordScore","CAI_Ubiquitous","CAI_Germline","CAI_Neurons","CAI_Somatic","CAI_1","TargetPies_3MM","TargetPies_4MM","TargetPies_5MM")

hengpi=c(6,4,6,3,3,3,3,7)
hengtosc=c(3,1.5,4,1.5,4.5,1.5,0,13.5)

###add data then introns then its done
#rps-5
#uno="gtttgtatttcgtatttggttaaaaattgcatttaaaaaatattgataaaaatatttccaaaaagagtaaaacaaaaaattaaattaatttttacag"
#dos="gtatatcattgattaaatgtagaaattttattttaccacgtttctattcag"
#tres="gtatattaattttcctggtgattcgtttaatcatttagttctttttag"
uno="gtgagttttattatcgattttcgggattttctacttgtaattaccttttgtttttaataagttgcttttttccag"
dos="gtaggttttcagtttcaatttttgttgcaactacctcaactctatgttttcag"
tres="gtaaatttttcaagcttctaaattccaaaataaaccattttaatttcttaattccag"

ffgg=cbind(SGFPs,hengpi,hengtosc)
colnames(ffgg)[(ncol(ffgg)-1):ncol(ffgg)]=c("HengsPis","HengTotalScores")

nnggseqs=c()
for(seq in ffgg$Sequence){
  seq=unlist(strsplit(seq,""))
  nnggseqs=append(nnggseqs,paste(paste(seq[1:intloc[1]],sep="",collapse=""),uno,paste(seq[(intloc[1]+1):intloc[2]],sep="",collapse=""),dos,paste(seq[(intloc[2]+1):intloc[3]],sep="",collapse=""),tres,paste(seq[(intloc[3]+1):length(seq)],sep="",collapse=""),collapse="",sep=""))
}

ffgg$Sequence=nnggseqs

write.table(ffgg,"CAI_WormScarletts_vals.tsv",sep="\t",col.names=T,row.names=F, quote=F)
    








